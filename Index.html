<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商品管理</title>
    <script>
        const baseUrl = "http://localhost:8080"; // 你的後端 API 部署網址

        // 查詢商品列表
        async function fetchProducts() {
            const response = await fetch(`${baseUrl}/products`);
            const data = await response.json();
            console.log(data); // 這裡可以將資料顯示到網頁上
            const productList = document.getElementById("product-list");
            productList.innerHTML = "";
            data.results.forEach(product => {
                const listItem = document.createElement("li");
                listItem.textContent = `商品名稱: ${product.product_name}, 價格: ${product.price}`;
                productList.appendChild(listItem);
            });
        }

        // 查詢單一商品
        async function fetchProductById(productId) {
            const response = await fetch(`${baseUrl}/products/${productId}`);
            const data = await response.json();
            console.log(data); // 顯示商品資訊
            document.getElementById("product-detail").textContent = JSON.stringify(data);
        }

        // 新增商品
        async function createProduct() {
            const productData = {
                product_name: document.getElementById("product-name").value,
                price: document.getElementById("product-price").value,
                stock: document.getElementById("product-stock").value
            };

            const response = await fetch(`${baseUrl}/products`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(productData)
            });

            if (response.status === 201) {
                const newProduct = await response.json();
                console.log("新增成功:", newProduct);
                fetchProducts(); // 更新商品列表
            } else {
                console.error("新增失敗");
            }
        }

        // 更新商品
        async function updateProduct(productId) {
            const productData = {
                product_name: document.getElementById("update-product-name").value,
                price: document.getElementById("update-product-price").value,
                stock: document.getElementById("update-product-stock").value
            };

            const response = await fetch(`${baseUrl}/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(productData)
            });

            if (response.status === 200) {
                const updatedProduct = await response.json();
                console.log("更新成功:", updatedProduct);
                fetchProducts(); // 更新商品列表
            } else {
                console.error("更新失敗");
            }
        }

        // 刪除商品
        async function deleteProduct(productId) {
            const response = await fetch(`${baseUrl}/products/${productId}`, {
                method: 'DELETE'
            });

            if (response.status === 204) {
                console.log("刪除成功");
                fetchProducts(); // 更新商品列表
            } else {
                console.error("刪除失敗");
            }
        }
    </script>
</head>
<body>
    <h1>商品管理系統</h1>

    <h2>商品列表</h2>
    <button onclick="fetchProducts()">查詢商品列表</button>
    <ul id="product-list"></ul>

    <h2>查詢單一商品</h2>
    <input type="number" id="product-id" placeholder="輸入商品 ID">
    <button onclick="fetchProductById(document.getElementById('product-id').value)">查詢商品</button>
    <div id="product-detail"></div>

    <h2>新增商品</h2>
    <input type="text" id="product-name" placeholder="商品名稱">
    <input type="number" id="product-price" placeholder="商品價格">
    <input type="number" id="product-stock" placeholder="庫存">
    <button onclick="createProduct()">新增商品</button>

    <h2>更新商品</h2>
    <input type="number" id="update-product-id" placeholder="商品 ID">
    <input type="text" id="update-product-name" placeholder="商品名稱">
    <input type="number" id="update-product-price" placeholder="商品價格">
    <input type="number" id="update-product-stock" placeholder="庫存">
    <button onclick="updateProduct(document.getElementById('update-product-id').value)">更新商品</button>

    <h2>刪除商品</h2>
    <input type="number" id="delete-product-id" placeholder="商品 ID">
    <button onclick="deleteProduct(document.getElementById('delete-product-id').value)">刪除商品</button>
</body>
</html>
